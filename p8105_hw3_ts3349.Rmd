---
title: "p8105_hw3_ts3349"
author: "Tessa Senders"
date: "10/6/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load libraries}
library(tidyverse)
library(p8105.datasets)
```

## Problem 1


```{r load data prob 1}
data("instacart")
```
This dataset contains `r nrow(instacart)` rows and `r ncol(instacart)` columns.  Observations are the level of items in orders by user.  There are user/order variables-user ID, order ID, order day, and order hour.  There are also item variables-name, aisle, department, and some numeric codes.



How many aisles and which are most items from?

```{r prob 1 counting}
instacart %>%
  count(aisle) %>%
  arrange(desc(n))
```

Plot

```{r prob 1 plot}
instacart %>%
  count(aisle) %>%
  filter(n > 10000) %>%
  mutate(
    aisle = factor(aisle),
    aisle = fct_reorder(aisle, n)
  ) %>%
  ggplot(aes(x = aisle, y = n)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 270, vjust = 0.5, hjust = 1))
```

Table

```{r prob 1 table}
instacart %>%
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>%
  group_by(aisle) %>%
  count(product_name) %>%
  mutate(rank = min_rank(desc(n))) %>%
  filter(rank < 4) %>%
  arrange(aisle, rank) %>%
  knitr::kable()

```

Second Table

```{r prob 1 table 2}
instacart %>%
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>%
  group_by(product_name, order_dow) %>%
  summarize(mean_hour = mean(order_hour_of_day)) %>%
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hour
  ) %>%
  knitr::kable()

```

## Problem 2

Load, tidy, and otherwise wrangle the data. Your final dataset should include all originally observed variables and values; have useful variable names; include a weekday vs weekend variable; and encode data with reasonable variable classes. Describe the resulting dataset (e.g. what variables exist, how many observations, etc).

Bullet 1: need to pivot longer with activity variables (activity count and minute of the day)
mutate to add weekend vs weekday
make numeric things numeric and make order make sense!


```{r problem 2 bullet 1}
activity_df <- read_csv("./data/accel_data.csv") %>%
  janitor::clean_names() %>%
  pivot_longer(
    activity_1:activity_1440,
    names_to = "minute_of_day", 
    values_to = "activity_count"
  ) %>%
  mutate(day = str_to_lower(day)) %>%
  mutate(day_temp = as.numeric(factor(day, levels = str_c(c("saturday", "sunday", "monday", "tuesday", "wednesday", "thursday", "friday"))))) %>%
  mutate(day_of_week = if_else(day_temp == 1 | day_temp == 2, "weekend", "weekday")) %>%
  select(!day_temp)%>%
  mutate(minute_of_day = as.numeric(str_remove(minute_of_day, "activity_")))

head(activity_df)  
```



Traditional analyses of accelerometer data focus on the total activity over the day. Using your tidied dataset, aggregate accross minutes to create a total activity variable for each day, and create a table showing these totals. Are any trends apparent?

Bullet 2: aggregate something to create total (group by and summarize- week, day or id or something, aggregate using mean or sum or something).  end up with 35 days in table, need to arrange table columns (week number day of the week).  understand whats going on in the table

```{r problem 2 bullet 2}
activity_table_df <- activity_df %>% 
  group_by(day_id, week) %>%
  summarize(total_activity = sum(activity_count)) %>%
  relocate(week)

activity_table_df %>%
  knitr::kable()
```




Bullet 3: ggplot, need to fix data (minute on x axis, activity count on y axis), want activity at eveyr minute of every day, geom_line but dont use scatterplot, use color for day of the week (aes mapping), describe patterns in plot (which days less or more active, when are they asleep?).  have 35 squiggly lines

Accelerometer data allows the inspection activity over the course of the day. Make a single-panel plot that shows the 24-hour activity time courses for each day and use color to indicate day of the week. Describe in words any patterns or conclusions you can make based on this graph.

```{r problem 2 bullet 3}
activity_df  %>% 
  ggplot(aes(x = minute_of_day, y = activity_count, color = day)) + 
  geom_line() + 
  labs(
    title = "Activity Over the Course of the Day",
    x = "Minute of the Day",
    y = "Activity Count",
    caption = "Data from the accelerometer data collected on a 63 year-old male with BMI 25"
  )
```

Hints:
day of the week columns will be in wrong order-use factor to fix
check if minute of the day is numeric or not?  do not want character variable

## Problem 3

Bullet 1: need to separate date to get three variables.  do not need to convert month to name.  change units on variables to something useful (want to round to integers?).  need to count snowfall.  

Bullet 2: data manipulation followed by plotting.  want january and july and avg max temp in each station across years group by (station, year, month) and then summarize, then filter by month (want january and july only).  each station have avg max temp.  plot those.  avg max temp over years.  many line stacked on each other.  use facet for two panel plot.  what structure appears?  january hotter now?  global warming happening?  some stations always colder?

Bullet 3: two distinct plots need to be joined via patchwork.  1st plot-contour or hex plot not scatterplot.  2nd plot-filter and then show distribution (boxplot, violin, ridge, etc)-one box for each year.





